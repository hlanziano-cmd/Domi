<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Control de Domicilios - Sistema Profesional</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <style>
        * { box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; 
            margin: 0; padding: 0; background-color: #f8fafc; line-height: 1.6;
        }
        .loading { 
            display: flex; justify-content: center; align-items: center; height: 100vh; 
            font-size: 18px; color: #6B7280; flex-direction: column; 
        }
        .spinner { 
            border: 3px solid #f3f4f6; border-top: 3px solid #3b82f6; border-radius: 50%; 
            width: 40px; height: 40px; animation: spin 1s linear infinite; margin-bottom: 16px; 
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .metric-card { 
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; 
            cursor: pointer;
        }
        .metric-card:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1); }
        .btn-primary { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            transition: all 0.3s ease; border: none; outline: none;
        }
        .btn-primary:hover { 
            transform: translateY(-1px); 
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        .whatsapp-btn {
            background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
        }
        .whatsapp-btn:hover {
            background: linear-gradient(135deg, #128C7E 0%, #075E54 100%);
        }
        .status-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        .status-pending { background: #FEF3C7; color: #92400E; }
        .status-in-transit { background: #DBEAFE; color: #1E40AF; }
        .status-delivered { background: #D1FAE5; color: #065F46; }
        .status-cancelled { background: #FEE2E2; color: #991B1B; }
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background: white;
            padding: 24px;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        .gps-active {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .timer-display {
            font-size: 3rem;
            font-weight: bold;
            color: #3b82f6;
            text-align: center;
            font-variant-numeric: tabular-nums;
        }
        .waitlist-item {
            position: relative;
            padding-left: 40px;
        }
        .waitlist-number {
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        .gps-required-warning {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 16px;
            animation: shake 0.5s;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;

        // Configuración de Firebase - REEMPLAZA CON TUS CREDENCIALES
        const firebaseConfig = {
            apiKey: "AIzaSyBXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",
            authDomain: "tu-proyecto.firebaseapp.com",
            databaseURL: "https://tu-proyecto-default-rtdb.firebaseio.com",
            projectId: "tu-proyecto",
            storageBucket: "tu-proyecto.appspot.com",
            messagingSenderId: "123456789012",
            appId: "1:123456789012:web:abcdef1234567890abcdef"
        };

        // Inicializar Firebase
        let database;
        try {
            if (!firebase.apps.length) {
                firebase.initializeApp(firebaseConfig);
            }
            database = firebase.database();
        } catch (error) {
            console.error("Error inicializando Firebase:", error);
        }

        const DeliverySystem = () => {
            const [loading, setLoading] = useState(true);
            const [orders, setOrders] = useState([]);
            const [deliveryPersons, setDeliveryPersons] = useState([]);
            const [waitlist, setWaitlist] = useState([]);
            const [activeTab, setActiveTab] = useState('dashboard');
            const [showModal, setShowModal] = useState(false);
            const [modalType, setModalType] = useState('');
            const [notification, setNotification] = useState({ show: false, message: '', type: '' });
            const [filterDate, setFilterDate] = useState('');
            const [isDeliveryPersonView, setIsDeliveryPersonView] = useState(false);
            const [currentDeliveryPerson, setCurrentDeliveryPerson] = useState(null);
            const [deliveryPersonLocation, setDeliveryPersonLocation] = useState({});
            const [isTrackingLocation, setIsTrackingLocation] = useState(false);
            const [watchId, setWatchId] = useState(null);
            const [activeTimers, setActiveTimers] = useState({});

            const [formData, setFormData] = useState({
                customerName: '',
                customerPhone: '',
                address: '',
                orderValue: '',
                deliveryPerson: '',
                personName: '',
                personPhone: ''
            });

            // Sincronizar con Firebase o usar localStorage como fallback
            useEffect(() => {
                if (!database) {
                    // Fallback a localStorage si Firebase no está configurado
                    const savedOrders = localStorage.getItem('deliveryOrders_v3');
                    const savedPersons = localStorage.getItem('deliveryPersons_v3');
                    const savedWaitlist = localStorage.getItem('waitlist_v3');
                    
                    if (savedOrders) setOrders(JSON.parse(savedOrders));
                    if (savedPersons) setDeliveryPersons(JSON.parse(savedPersons));
                    if (savedWaitlist) setWaitlist(JSON.parse(savedWaitlist));
                    
                    setLoading(false);
                    return;
                }

                const ordersRef = database.ref('orders');
                const personsRef = database.ref('deliveryPersons');
                const waitlistRef = database.ref('waitlist');
                const locationsRef = database.ref('locations');

                ordersRef.on('value', (snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        setOrders(Object.values(data));
                    }
                });

                personsRef.on('value', (snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        setDeliveryPersons(Object.values(data));
                    }
                });

                waitlistRef.on('value', (snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        setWaitlist(Object.values(data));
                    } else {
                        setWaitlist([]);
                    }
                });

                locationsRef.on('value', (snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        setDeliveryPersonLocation(data);
                    }
                });

                return () => {
                    ordersRef.off();
                    personsRef.off();
                    waitlistRef.off();
                    locationsRef.off();
                };
            }, []);

            // Guardar en localStorage como backup si no hay Firebase
            useEffect(() => {
                if (!database) {
                    localStorage.setItem('deliveryOrders_v3', JSON.stringify(orders));
                }
            }, [orders]);

            useEffect(() => {
                if (!database) {
                    localStorage.setItem('deliveryPersons_v3', JSON.stringify(deliveryPersons));
                }
            }, [deliveryPersons]);

            useEffect(() => {
                if (!database) {
                    localStorage.setItem('waitlist_v3', JSON.stringify(waitlist));
                }
            }, [waitlist]);

            useEffect(() => {
                const loadData = async () => {
                    try {
                        await new Promise(resolve => setTimeout(resolve, 1500));
                        
                        const urlParams = new URLSearchParams(window.location.search);
                        const deliveryPersonId = urlParams.get('repartidor');
                        
                        if (deliveryPersonId) {
                            let persons = [];
                            if (database) {
                                const personsSnapshot = await database.ref('deliveryPersons').once('value');
                                const personsData = personsSnapshot.val();
                                if (personsData) persons = Object.values(personsData);
                            } else {
                                const savedPersons = localStorage.getItem('deliveryPersons_v3');
                                if (savedPersons) persons = JSON.parse(savedPersons);
                            }
                            
                            const person = persons.find(p => p.id === parseInt(deliveryPersonId));
                            if (person) {
                                setIsDeliveryPersonView(true);
                                setCurrentDeliveryPerson(person);
                                showNotification(`¡Bienvenido ${person.name}!`, 'success');
                            }
                        }
                        
                        setLoading(false);
                    } catch (error) {
                        console.error('Error cargando datos:', error);
                        setLoading(false);
                    }
                };
                loadData();
            }, []);

            // Timer Effect
            useEffect(() => {
                const interval = setInterval(() => {
                    setActiveTimers(prev => {
                        const updated = { ...prev };
                        Object.keys(updated).forEach(orderId => {
                            if (updated[orderId].isRunning) {
                                updated[orderId].elapsed += 1;
                            }
                        });
                        return updated;
                    });
                }, 1000);

                return () => clearInterval(interval);
            }, []);

            const showNotification = (message, type = 'info') => {
                setNotification({ show: true, message, type });
                setTimeout(() => setNotification({ show: false, message: '', type: '' }), 3000);
            };

            const formatNumber = (num) => {
                return new Intl.NumberFormat('es-CO').format(num);
            };

            const formatTime = (seconds) => {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            };

            const handleInputChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({ ...prev, [name]: value }));
            };

            const createOrder = async () => {
                if (!formData.customerName || !formData.customerPhone || !formData.address || !formData.orderValue) {
                    showNotification('Por favor completa todos los campos', 'error');
                    return;
                }

                const newOrder = {
                    id: Date.now(),
                    customerName: formData.customerName,
                    customerPhone: formData.customerPhone,
                    address: formData.address,
                    orderValue: parseFloat(formData.orderValue),
                    status: 'pending',
                    deliveryPerson: formData.deliveryPerson || null,
                    createdAt: new Date().toISOString(),
                    deliveryTime: null,
                    startTime: null,
                    endTime: null,
                    rating: null
                };

                if (database) {
                    await database.ref(`orders/${newOrder.id}`).set(newOrder);
                } else {
                    setOrders(prev => [...prev, newOrder]);
                }
                
                setFormData({ customerName: '', customerPhone: '', address: '', orderValue: '', deliveryPerson: '' });
                setShowModal(false);
                showNotification('¡Pedido creado exitosamente!', 'success');
            };

            const addDeliveryPerson = async () => {
                if (!formData.personName || !formData.personPhone) {
                    showNotification('Por favor completa nombre y teléfono', 'error');
                    return;
                }

                const newPerson = {
                    id: Date.now(),
                    name: formData.personName,
                    phone: formData.personPhone,
                    isActive: true,
                    gpsActive: false,
                    totalDeliveries: 0,
                    activeOrders: 0
                };

                if (database) {
                    await database.ref(`deliveryPersons/${newPerson.id}`).set(newPerson);
                } else {
                    setDeliveryPersons(prev => [...prev, newPerson]);
                }
                
                setFormData({ ...formData, personName: '', personPhone: '' });
                setShowModal(false);
                showNotification('¡Repartidor agregado exitosamente!', 'success');
            };

            const deleteDeliveryPerson = async (personId) => {
                const hasActiveOrders = orders.some(o => 
                    o.deliveryPerson === deliveryPersons.find(p => p.id === personId)?.name && 
                    o.status !== 'delivered' && o.status !== 'cancelled'
                );

                if (hasActiveOrders) {
                    showNotification('No se puede eliminar: tiene pedidos activos', 'error');
                    return;
                }

                if (window.confirm('¿Estás seguro de eliminar este repartidor?')) {
                    if (database) {
                        await database.ref(`deliveryPersons/${personId}`).remove();
                        await database.ref(`waitlist/${personId}`).remove();
                    } else {
                        setDeliveryPersons(prev => prev.filter(p => p.id !== personId));
                        setWaitlist(prev => prev.filter(w => w.personId !== personId));
                    }
                    showNotification('Repartidor eliminado', 'success');
                }
            };

            const startTimer = (orderId) => {
                setActiveTimers(prev => ({
                    ...prev,
                    [orderId]: {
                        startTime: Date.now(),
                        elapsed: 0,
                        isRunning: true
                    }
                }));
            };

            const stopTimer = (orderId) => {
                setActiveTimers(prev => ({
                    ...prev,
                    [orderId]: {
                        ...prev[orderId],
                        isRunning: false
                    }
                }));
                return activeTimers[orderId]?.elapsed || 0;
            };

            const updateOrderStatus = async (orderId, newStatus) => {
                const order = orders.find(o => o.id === orderId);
                if (!order) return;

                const updates = { status: newStatus };

                if (newStatus === 'in-transit') {
                    updates.startTime = new Date().toISOString();
                    startTimer(orderId);
                } else if (newStatus === 'delivered') {
                    updates.endTime = new Date().toISOString();
                    const elapsedSeconds = stopTimer(orderId);
                    updates.deliveryTime = Math.round(elapsedSeconds / 60);
                }

                if (database) {
                    await database.ref(`orders/${orderId}`).update(updates);
                } else {
                    setOrders(prev => prev.map(o => o.id === orderId ? { ...o, ...updates } : o));
                }
                
                showNotification('Estado actualizado', 'success');
            };

            const assignDeliveryPerson = async (orderId, personName) => {
                if (database) {
                    await database.ref(`orders/${orderId}`).update({ deliveryPerson: personName });
                } else {
                    setOrders(prev => prev.map(o => o.id === orderId ? { ...o, deliveryPerson: personName } : o));
                }
                showNotification('Repartidor asignado', 'success');
            };

            const copyDeliveryPersonUrl = (personId, personName) => {
                const baseUrl = window.location.origin + window.location.pathname;
                const url = `${baseUrl}?repartidor=${personId}`;
                
                navigator.clipboard.writeText(url).then(() => {
                    showNotification('¡Enlace copiado!', 'success');
                    
                    const person = deliveryPersons.find(p => p.id === personId);
                    if (person && person.phone) {
                        const message = `¡Hola ${personName}! ??\n\nTu enlace de acceso al sistema de domicilios:\n${url}\n\nInstrucciones:\n1. ??? Activa el GPS (OBLIGATORIO)\n2. ?? Únete a la lista de espera\n3. ? Acepta pedidos cuando sea tu turno\n4. ?? El cronómetro iniciará automáticamente\n5. ?? Marca como entregado al finalizar\n\n¡Bienvenido al equipo! ??`;
                        const whatsappUrl = `https://wa.me/${person.phone.replace(/\D/g, '')}?text=${encodeURIComponent(message)}`;
                        window.open(whatsappUrl, '_blank');
                    }
                });
            };

            const startTracking = async (personId) => {
                if (!navigator.geolocation) {
                    showNotification('GPS no disponible en este dispositivo', 'error');
                    return;
                }

                const id = navigator.geolocation.watchPosition(
                    async (position) => {
                        const location = {
                            personId,
                            lat: position.coords.latitude,
                            lng: position.coords.longitude,
                            accuracy: position.coords.accuracy,
                            timestamp: new Date().toISOString()
                        };
                        
                        if (database) {
                            await database.ref(`locations/${personId}`).set(location);
                            await database.ref(`deliveryPersons/${personId}`).update({ gpsActive: true });
                        } else {
                            setDeliveryPersonLocation(prev => ({ ...prev, [personId]: location }));
                            setDeliveryPersons(prev => prev.map(p => 
                                p.id === personId ? { ...p, gpsActive: true } : p
                            ));
                        }
                        
                        setIsTrackingLocation(true);
                        showNotification('GPS activado', 'success');
                    },
                    (error) => {
                        showNotification('Error al obtener ubicación', 'error');
                        console.error(error);
                    },
                    { enableHighAccuracy: true, maximumAge: 10000, timeout: 5000 }
                );
                setWatchId(id);
            };

            const stopTracking = async (personId) => {
                if (watchId) {
                    navigator.geolocation.clearWatch(watchId);
                    setWatchId(null);
                    setIsTrackingLocation(false);
                    
                    if (database) {
                        await database.ref(`deliveryPersons/${personId}`).update({ gpsActive: false });
                    } else {
                        setDeliveryPersons(prev => prev.map(p => 
                            p.id === personId ? { ...p, gpsActive: false } : p
                        ));
                    }
                    
                    showNotification('GPS desactivado', 'info');
                }
            };

            const joinWaitlist = async (personId, personName) => {
                const person = deliveryPersons.find(p => p.id === personId);
                if (!person?.gpsActive) {
                    showNotification('?? Debes activar el GPS primero', 'error');
                    return;
                }

                const existsInWaitlist = waitlist.some(w => w.personId === personId);
                if (existsInWaitlist) {
                    showNotification('Ya estás en la lista de espera', 'info');
                    return;
                }

                const newEntry = {
                    personId,
                    personName,
                    joinedAt: new Date().toISOString(),
                    position: waitlist.length + 1
                };

                if (database) {
                    await database.ref(`waitlist/${personId}`).set(newEntry);
                } else {
                    setWaitlist(prev => [...prev, newEntry]);
                }
                
                showNotification('? Te has unido a la lista de espera', 'success');
            };

            const leaveWaitlist = async (personId) => {
                if (database) {
                    await database.ref(`waitlist/${personId}`).remove();
                } else {
                    setWaitlist(prev => prev.filter(w => w.personId !== personId));
                }
                showNotification('Has salido de la lista de espera', 'info');
            };

            const acceptOrder = async (orderId, personId) => {
                const person = deliveryPersons.find(p => p.id === personId);
                
                if (!person?.gpsActive) {
                    showNotification('?? Debes activar el GPS para aceptar pedidos', 'error');
                    return;
                }

                await updateOrderStatus(orderId, 'in-transit');
                showNotification('¡Pedido aceptado! Cronómetro iniciado', 'success');
            };

            const getStats = () => {
                const today = new Date().toISOString().split('T')[0];
                const todayOrders = orders.filter(o => o.createdAt.startsWith(today));
                
                return {
                    total: orders.length,
                    pending: orders.filter(o => o.status === 'pending').length,
                    inTransit: orders.filter(o => o.status === 'in-transit').length,
                    delivered: orders.filter(o => o.status === 'delivered').length,
                    todayOrders: todayOrders.length,
                    todayRevenue: todayOrders.reduce((sum, o) => sum + (o.orderValue || 0), 0)
                };
            };

            const stats = getStats();

            const Icon = ({ d, className = "w-5 h-5" }) => (
                <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d={d} />
                </svg>
            );

            const icons = {
                home: "M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6",
                package: "M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4",
                truck: "M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l3.414 3.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0m-4 0a2 2 0 114 0m6 0a2 2 0 104 0m-4 0a2 2 0 114 0",
                users: "M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z",
                plus: "M12 4v16m8-8H4",
                phone: "M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z",
                location: "M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z M15 11a3 3 0 11-6 0 3 3 0 016 0z",
                check: "M5 13l4 4L19 7",
                clock: "M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
            };

            if (loading) {
                return (
                    <div className="loading">
                        <div className="spinner"></div>
                        <p>Cargando sistema...</p>
                    </div>
                );
            }

            if (isDeliveryPersonView && currentDeliveryPerson) {
                const myOrders = orders.filter(o => o.deliveryPerson === currentDeliveryPerson.name);
                const myStats = {
                    pending: myOrders.filter(o => o.status === 'pending').length,
                    inTransit: myOrders.filter(o => o.status === 'in-transit').length,
                    delivered: myOrders.filter(o => o.status === 'delivered').length
                };

                const myPosition = waitlist.findIndex(w => w.personId === currentDeliveryPerson.id) + 1;
                const inWaitlist = myPosition > 0;

                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4">
                        {notification.show && (
                            <div className={`fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 ${
                                notification.type === 'success' ? 'bg-green-500' :
                                notification.type === 'error' ? 'bg-red-500' : 'bg-blue-500'
                            } text-white`}>
                                {notification.message}
                            </div>
                        )}

                        <div className="max-w-4xl mx-auto">
                            <div className="bg-white rounded-xl shadow-lg p-6 mb-6">
                                <div className="flex justify-between items-center mb-4">
                                    <div>
                                        <h1 className="text-2xl font-bold text-gray-900">¡Hola {currentDeliveryPerson.name}! ??</h1>
                                        <p className="text-gray-600">Panel de Repartidor</p>
                                    </div>
                                    <div className="text-right">
                                        <p className="text-sm text-gray-500">Tel: {currentDeliveryPerson.phone}</p>
                                        {currentDeliveryPerson.gpsActive && (
                                            <span className="text-xs text-green-600 font-bold">?? GPS Activo</span>
                                        )}
                                    </div>
                                </div>

                                {!currentDeliveryPerson.gpsActive && (
                                    <div className="gps-required-warning">
                                        <div className="flex items-center gap-2">
                                            <span className="text-2xl">??</span>
                                            <div>
                                                <p className="font-bold">GPS Requerido</p>
                                                <p className="text-sm">Debes activar el GPS para aceptar pedidos</p>
                                            </div>
                                        </div>
                                    </div>
                                )}

                                <div className="grid grid-cols-3 gap-4 mb-6">
                                    <div className="bg-yellow-50 p-4 rounded-lg text-center">
                                        <div className="text-2xl font-bold text-yellow-600">{myStats.pending}</div>
                                        <div className="text-sm text-gray-600">Pendientes</div>
                                    </div>
                                    <div className="bg-blue-50 p-4 rounded-lg text-center">
                                        <div className="text-2xl font-bold text-blue-600">{myStats.inTransit}</div>
                                        <div className="text-sm text-gray-600">En Tránsito</div>
                                    </div>
                                    <div className="bg-green-50 p-4 rounded-lg text-center">
                                        <div className="text-2xl font-bold text-green-600">{myStats.delivered}</div>
                                        <div className="text-sm text-gray-600">Entregados</div>
                                    </div>
                                </div>

                                <div className="bg-gradient-to-r from-blue-500 to-indigo-600 p-6 rounded-xl text-white mb-4">
                                    <div className="flex items-center justify-between mb-4">
                                        <div className="flex items-center gap-2">
                                            <Icon d={icons.location} className="w-6 h-6" />
                                            <span className="font-bold">Control GPS</span>
                                        </div>
                                        {isTrackingLocation && (
                                            <span className="gps-active">?? Activo</span>
                                        )}
                                    </div>
                                    
                                    {!isTrackingLocation ? (
                                        <button
                                            onClick={() => startTracking(currentDeliveryPerson.id)}
                                            className="w-full bg-white text-blue-600 py-3 rounded-lg font-bold hover:bg-blue-50 transition"
                                        >
                                            ??? ACTIVAR GPS
                                        </button>
                                    ) : (
                                        <div className="space-y-3">
                                            <div className="bg-white/20 p-3 rounded-lg">
                                                <p className="text-sm mb-1">?? Ubicación Actual:</p>
                                                <p className="text-xs font-mono">
                                                    {deliveryPersonLocation[currentDeliveryPerson.id]?.lat.toFixed(6)}, {deliveryPersonLocation[currentDeliveryPerson.id]?.lng.toFixed(6)}
                                                </p>
                                                <p className="text-xs mt-1">Precisión: {deliveryPersonLocation[currentDeliveryPerson.id]?.accuracy?.toFixed(0)}m</p>
                                            </div>
                                            <div className="flex gap-2">
                                                <button
                                                    onClick={() => window.open(`https://www.google.com/maps?q=${deliveryPersonLocation[currentDeliveryPerson.id]?.lat},${deliveryPersonLocation[currentDeliveryPerson.id]?.lng}`, '_blank')}
                                                    className="flex-1 bg-white text-blue-600 py-2 rounded-lg text-sm font-bold"
                                                >
                                                    Ver en Maps
                                                </button>
                                                <button
                                                    onClick={() => stopTracking(currentDeliveryPerson.id)}
                                                    className="flex-1 bg-red-500 text-white py-2 rounded-lg text-sm font-bold"
                                                >
                                                    Detener
                                                </button>
                                            </div>
                                        </div>
                                    )}
                                </div>

                                <div className="bg-gradient-to-r from-purple-500 to-pink-600 p-6 rounded-xl text-white">
                                    <div className="flex items-center gap-2 mb-4">
                                        <Icon d={icons.users} className="w-6 h-6" />
                                        <span className="font-bold">Lista de Espera</span>
                                    </div>
                                    
                                    {!inWaitlist ? (
                                        <button
                                            onClick={() => joinWaitlist(currentDeliveryPerson.id, currentDeliveryPerson.name)}
                                            disabled={!currentDeliveryPerson.gpsActive}
                                            className={`w-full py-3 rounded-lg font-bold transition ${
                                                currentDeliveryPerson.gpsActive 
                                                    ? 'bg-white text-purple-600 hover:bg-purple-50' 
                                                    : 'bg-gray-300 text-gray-500 cursor-not-allowed'
                                            }`}
                                        >
                                            {currentDeliveryPerson.gpsActive ? '?? Unirse a la Lista' : '?? Activa GPS primero'}
                                        </button>
                                    ) : (
                                        <div className="space-y-3">
                                            <div className="bg-white/20 p-4 rounded-lg text-center">
                                                <p className="text-sm mb-2">Tu posición en la fila:</p>
                                                <p className="text-5xl font-bold">{myPosition}</p>
                                                <p className="text-sm mt-2">de {waitlist.length} repartidores</p>
                                            </div>
                                            <button
                                                onClick={() => leaveWaitlist(currentDeliveryPerson.id)}
                                                className="w-full bg-red-500 text-white py-2 rounded-lg font-bold"
                                            >
                                                Salir de la Lista
                                            </button>
                                        </div>
                                    )}
                                </div>
                            </div>

                            <div className="space-y-4">
                                <h2 className="text-xl font-bold text-gray-900">Mis Pedidos</h2>
                                
                                {myOrders.filter(o => o.status !== 'delivered' && o.status !== 'cancelled').map(order => {
                                    const timer = activeTimers[order.id];
                                    const showTimer = order.status === 'in-transit' && timer?.isRunning;

                                    return (
                                        <div key={order.id} className="bg-white rounded-xl shadow-lg p-6">
                                            <div className="flex justify-between items-start mb-4">
                                                <div>
                                                    <h3 className="font-bold text-lg">{order.customerName}</h3>
                                                    <p className="text-gray-600 text-sm">{order.address}</p>
                                                </div>
                                                <span className={`status-badge status-${order.status}`}>
                                                    {order.status === 'pending' ? '? Pendiente' : '?? En Tránsito'}
                                                </span>
                                            </div>

                                            {showTimer && (
                                                <div className="bg-blue-50 p-6 rounded-xl mb-4">
                                                    <div className="flex items-center justify-center gap-2 mb-2">
                                                        <Icon d={icons.clock} className="w-6 h-6 text-blue-600" />
                                                        <span className="text-sm font-bold text-blue-600">TIEMPO DE ENTREGA</span>
                                                    </div>
                                                    <div className="timer-display">
                                                        {formatTime(timer.elapsed)}
                                                    </div>
                                                    <p className="text-center text-sm text-gray-600 mt-2">
                                                        {Math.floor(timer.elapsed / 60)} minutos
                                                    </p>
                                                </div>
                                            )}

                                            <div className="bg-gray-50 p-4 rounded-lg mb-4">
                                                <div className="flex justify-between items-center">
                                                    <span className="text-gray-600">Valor del pedido:</span>
                                                    <span className="font-bold text-green-600 text-xl">${formatNumber(order.orderValue)}</span>
                                                </div>
                                            </div>

                                            <div className="grid grid-cols-2 gap-3">
                                                {order.status === 'pending' && (
                                                    <button
                                                        onClick={() => acceptOrder(order.id, currentDeliveryPerson.id)}
                                                        disabled={!currentDeliveryPerson.gpsActive}
                                                        className={`py-3 rounded-lg font-bold transition ${
                                                            currentDeliveryPerson.gpsActive
                                                                ? 'bg-blue-500 text-white hover:bg-blue-600'
                                                                : 'bg-gray-300 text-gray-500 cursor-not-allowed'
                                                        }`}
                                                    >
                                                        {currentDeliveryPerson.gpsActive ? '? ACEPTAR PEDIDO' : '?? GPS Requerido'}
                                                    </button>
                                                )}
                                                {order.status === 'in-transit' && (
                                                    <button
                                                        onClick={() => updateOrderStatus(order.id, 'delivered')}
                                                        className="bg-green-500 text-white py-3 rounded-lg font-bold hover:bg-green-600 transition"
                                                    >
                                                        ?? MARCAR ENTREGADO
                                                    </button>
                                                )}
                                                <button
                                                    onClick={() => window.open(`https://wa.me/${order.customerPhone.replace(/\D/g, '')}?text=Hola ${order.customerName}, soy tu repartidor. Estoy en camino con tu pedido a ${order.address}. ¿Hay alguna indicación especial?`, '_blank')}
                                                    className="whatsapp-btn text-white py-3 rounded-lg font-bold"
                                                >
                                                    ?? WHATSAPP
                                                </button>
                                            </div>
                                        </div>
                                    );
                                })}

                                {myOrders.filter(o => o.status !== 'delivered' && o.status !== 'cancelled').length === 0 && (
                                    <div className="bg-white rounded-xl shadow-lg p-12 text-center">
                                        <Icon d={icons.package} className="w-16 h-16 text-gray-300 mx-auto mb-4" />
                                        <h3 className="text-xl font-bold text-gray-900 mb-2">Sin pedidos activos</h3>
                                        <p className="text-gray-600">Los nuevos pedidos aparecerán aquí</p>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                );
            }

            // Vista Administrador - Continuará en la siguiente parte
            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
                    {notification.show && (
                        <div className={`fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 ${
                            notification.type === 'success' ? 'bg-green-500' :
                            notification.type === 'error' ? 'bg-red-500' : 'bg-blue-500'
                        } text-white`}>
                            {notification.message}
                        </div>
                    )}

                    {showModal && (
                        <div className="modal-overlay" onClick={() => setShowModal(false)}>
                            <div className="modal-content" onClick={(e) => e.stopPropagation()}>
                                <h2 className="text-2xl font-bold mb-6">
                                    {modalType === 'order' ? '?? Nuevo Pedido' : '?? Nuevo Repartidor'}
                                </h2>
                                
                                {modalType === 'order' ? (
                                    <div className="space-y-4">
                                        <input
                                            type="text"
                                            name="customerName"
                                            placeholder="Nombre del cliente"
                                            value={formData.customerName}
                                            onChange={handleInputChange}
                                            className="w-full p-3 border rounded-lg"
                                        />
                                        <input
                                            type="tel"
                                            name="customerPhone"
                                            placeholder="Teléfono"
                                            value={formData.customerPhone}
                                            onChange={handleInputChange}
                                            className="w-full p-3 border rounded-lg"
                                        />
                                        <input
                                            type="text"
                                            name="address"
                                            placeholder="Dirección de entrega"
                                            value={formData.address}
                                            onChange={handleInputChange}
                                            className="w-full p-3 border rounded-lg"
                                        />
                                        <input
                                            type="number"
                                            name="orderValue"
                                            placeholder="Valor del pedido"
                                            value={formData.orderValue}
                                            onChange={handleInputChange}
                                            className="w-full p-3 border rounded-lg"
                                        />
                                        <select
                                            name="deliveryPerson"
                                            value={formData.deliveryPerson}
                                            onChange={handleInputChange}
                                            className="w-full p-3 border rounded-lg"
                                        >
                                            <option value="">Asignar repartidor (opcional)</option>
                                            {deliveryPersons.map(person => (
                                                <option key={person.id} value={person.name}>{person.name}</option>
                                            ))}
                                        </select>
                                        <div className="flex gap-3">
                                            <button
                                                onClick={createOrder}
                                                className="flex-1 btn-primary text-white py-3 rounded-lg font-bold"
                                            >
                                                Crear Pedido
                                            </button>
                                            <button
                                                onClick={() => setShowModal(false)}
                                                className="flex-1 bg-gray-200 py-3 rounded-lg font-bold"
                                            >
                                                Cancelar
                                            </button>
                                        </div>
                                    </div>
                                ) : (
                                    <div className="space-y-4">
                                        <input
                                            type="text"
                                            name="personName"
                                            placeholder="Nombre del repartidor"
                                            value={formData.personName}
                                            onChange={handleInputChange}
                                            className="w-full p-3 border rounded-lg"
                                        />
                                        <input
                                            type="tel"
                                            name="personPhone"
                                            placeholder="Teléfono"
                                            value={formData.personPhone}
                                            onChange={handleInputChange}
                                            className="w-full p-3 border rounded-lg"
                                        />
                                        <div className="flex gap-3">
                                            <button
                                                onClick={addDeliveryPerson}
                                                className="flex-1 btn-primary text-white py-3 rounded-lg font-bold"
                                            >
                                                Agregar Repartidor
                                            </button>
                                            <button
                                                onClick={() => setShowModal(false)}
                                                className="flex-1 bg-gray-200 py-3 rounded-lg font-bold"
                                            >
                                                Cancelar
                                            </button>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    )}

                    <div className="container mx-auto px-4 py-8">
                        <div className="mb-8">
                            <h1 className="text-4xl font-bold text-gray-900 mb-2">Sistema de Domicilios ??</h1>
                            <p className="text-gray-600">Panel de Control Administrativo</p>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                            <div className="metric-card bg-white rounded-xl shadow-lg p-6">
                                <div className="flex items-center justify-between mb-2">
                                    <Icon d={icons.package} className="w-8 h-8 text-blue-500" />
                                    <span className="text-3xl font-bold text-gray-900">{stats.total}</span>
                                </div>
                                <p className="text-gray-600 font-medium">Total Pedidos</p>
                            </div>

                            <div className="metric-card bg-white rounded-xl shadow-lg p-6">
                                <div className="flex items-center justify-between mb-2">
                                    <Icon d={icons.truck} className="w-8 h-8 text-yellow-500" />
                                    <span className="text-3xl font-bold text-gray-900">{stats.pending}</span>
                                </div>
                                <p className="text-gray-600 font-medium">Pendientes</p>
                            </div>

                            <div className="metric-card bg-white rounded-xl shadow-lg p-6">
                                <div className="flex items-center justify-between mb-2">
                                    <Icon d={icons.truck} className="w-8 h-8 text-blue-500" />
                                    <span className="text-3xl font-bold text-gray-900">{stats.inTransit}</span>
                                </div>
                                <p className="text-gray-600 font-medium">En Tránsito</p>
                            </div>

                            <div className="metric-card bg-white rounded-xl shadow-lg p-6">
                                <div className="flex items-center justify-between mb-2">
                                    <Icon d={icons.check} className="w-8 h-8 text-green-500" />
                                    <span className="text-3xl font-bold text-gray-900">{stats.delivered}</span>
                                </div>
                                <p className="text-gray-600 font-medium">Entregados</p>
                            </div>
                        </div>

                        <div className="bg-white rounded-xl shadow-lg mb-6">
                            <div className="flex border-b overflow-x-auto">
                                <button
                                    onClick={() => setActiveTab('dashboard')}
                                    className={`flex-1 py-4 font-bold whitespace-nowrap ${activeTab === 'dashboard' ? 'border-b-2 border-blue-500 text-blue-600' : 'text-gray-600'}`}
                                >
                                    ?? Dashboard
                                </button>
                                <button
                                    onClick={() => setActiveTab('orders')}
                                    className={`flex-1 py-4 font-bold whitespace-nowrap ${activeTab === 'orders' ? 'border-b-2 border-blue-500 text-blue-600' : 'text-gray-600'}`}
                                >
                                    ?? Pedidos
                                </button>
                                <button
                                    onClick={() => setActiveTab('delivery')}
                                    className={`flex-1 py-4 font-bold whitespace-nowrap ${activeTab === 'delivery' ? 'border-b-2 border-blue-500 text-blue-600' : 'text-gray-600'}`}
                                >
                                    ?? Repartidores
                                </button>
                                <button
                                    onClick={() => setActiveTab('waitlist')}
                                    className={`flex-1 py-4 font-bold whitespace-nowrap ${activeTab === 'waitlist' ? 'border-b-2 border-blue-500 text-blue-600' : 'text-gray-600'}`}
                                >
                                    ?? Lista de Espera
                                </button>
                            </div>

                            <div className="p-6">
                                {activeTab === 'dashboard' && (
                                    <div>
                                        <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6">
                                            <h2 className="text-2xl font-bold">Resumen del Día</h2>
                                            <div className="flex flex-wrap gap-3">
                                                <input
                                                    type="date"
                                                    value={filterDate}
                                                    onChange={(e) => setFilterDate(e.target.value)}
                                                    className="px-4 py-2 border rounded-lg"
                                                />
                                                <button
                                                    onClick={() => setFilterDate(new Date().toISOString().split('T')[0])}
                                                    className="px-4 py-2 bg-blue-500 text-white rounded-lg font-bold"
                                                >
                                                    Hoy
                                                </button>
                                                <button
                                                    onClick={() => setFilterDate('')}
                                                    className="px-4 py-2 bg-gray-200 rounded-lg font-bold"
                                                >
                                                    Ver Todos
                                                </button>
                                            </div>
                                        </div>

                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                            <div className="bg-gradient-to-r from-blue-500 to-indigo-600 text-white p-6 rounded-xl">
                                                <p className="text-sm mb-1">Pedidos Hoy</p>
                                                <p className="text-4xl font-bold">{stats.todayOrders}</p>
                                            </div>
                                            <div className="bg-gradient-to-r from-green-500 to-emerald-600 text-white p-6 rounded-xl">
                                                <p className="text-sm mb-1">Ingresos Hoy</p>
                                                <p className="text-4xl font-bold">${formatNumber(stats.todayRevenue)}</p>
                                            </div>
                                        </div>
                                    </div>
                                )}

                                {activeTab === 'orders' && (
                                    <div>
                                        <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6">
                                            <h2 className="text-2xl font-bold">Gestión de Pedidos</h2>
                                            <button
                                                onClick={() => {
                                                    setModalType('order');
                                                    setShowModal(true);
                                                }}
                                                className="btn-primary text-white px-6 py-3 rounded-lg font-bold flex items-center gap-2"
                                            >
                                                <Icon d={icons.plus} />
                                                Crear Pedido
                                            </button>
                                        </div>

                                        <div className="overflow-x-auto">
                                            <table className="w-full">
                                                <thead className="bg-gray-50">
                                                    <tr>
                                                        <th className="px-4 py-3 text-left text-sm font-bold">Cliente</th>
                                                        <th className="px-4 py-3 text-left text-sm font-bold">Dirección</th>
                                                        <th className="px-4 py-3 text-left text-sm font-bold">Valor</th>
                                                        <th className="px-4 py-3 text-left text-sm font-bold">Estado</th>
                                                        <th className="px-4 py-3 text-left text-sm font-bold">Repartidor</th>
                                                        <th className="px-4 py-3 text-left text-sm font-bold">Tiempo</th>
                                                        <th className="px-4 py-3 text-left text-sm font-bold">Acciones</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {orders.filter(o => !filterDate || o.createdAt.startsWith(filterDate)).map(order => {
                                                        const timer = activeTimers[order.id];
                                                        return (
                                                            <tr key={order.id} className="border-b hover:bg-gray-50">
                                                                <td className="px-4 py-4">
                                                                    <div>
                                                                        <p className="font-bold">{order.customerName}</p>
                                                                        <p className="text-sm text-gray-500">{order.customerPhone}</p>
                                                                    </div>
                                                                </td>
                                                                <td className="px-4 py-4 text-sm">{order.address}</td>
                                                                <td className="px-4 py-4">
                                                                    <span className="font-bold text-green-600">${formatNumber(order.orderValue)}</span>
                                                                </td>
                                                                <td className="px-4 py-4">
                                                                    <select
                                                                        value={order.status}
                                                                        onChange={(e) => updateOrderStatus(order.id, e.target.value)}
                                                                        className={`status-badge status-${order.status} border-0`}
                                                                    >
                                                                        <option value="pending">? Pendiente</option>
                                                                        <option value="in-transit">?? En Tránsito</option>
                                                                        <option value="delivered">? Entregado</option>
                                                                        <option value="cancelled">? Cancelado</option>
                                                                    </select>
                                                                </td>
                                                                <td className="px-4 py-4">
                                                                    <select
                                                                        value={order.deliveryPerson || ''}
                                                                        onChange={(e) => assignDeliveryPerson(order.id, e.target.value)}
                                                                        className="border rounded px-2 py-1 text-sm"
                                                                    >
                                                                        <option value="">Sin asignar</option>
                                                                        {deliveryPersons.map(p => (
                                                                            <option key={p.id} value={p.name}>{p.name}</option>
                                                                        ))}
                                                                    </select>
                                                                </td>
                                                                <td className="px-4 py-4">
                                                                    {order.status === 'in-transit' && timer?.isRunning ? (
                                                                        <span className="text-blue-600 font-bold">
                                                                            ?? {formatTime(timer.elapsed)}
                                                                        </span>
                                                                    ) : order.deliveryTime ? (
                                                                        <span className="text-green-600 font-bold">
                                                                            ? {order.deliveryTime} min
                                                                        </span>
                                                                    ) : (
                                                                        <span className="text-gray-400">-</span>
                                                                    )}
                                                                </td>
                                                                <td className="px-4 py-4">
                                                                    <button
                                                                        onClick={() => window.open(`https://wa.me/${order.customerPhone.replace(/\D/g, '')}`, '_blank')}
                                                                        className="whatsapp-btn text-white px-3 py-1 rounded text-sm"
                                                                    >
                                                                        ??
                                                                    </button>
                                                                </td>
                                                            </tr>
                                                        );
                                                    })}
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                )}

                                {activeTab === 'delivery' && (
                                    <div>
                                        <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6">
                                            <h2 className="text-2xl font-bold">Repartidores</h2>
                                            <button
                                                onClick={() => {
                                                    setModalType('person');
                                                    setShowModal(true);
                                                }}
                                                className="btn-primary text-white px-6 py-3 rounded-lg font-bold flex items-center gap-2"
                                            >
                                                <Icon d={icons.plus} />
                                                Agregar Repartidor
                                            </button>
                                        </div>

                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                            {deliveryPersons.map(person => (
                                                <div key={person.id} className="bg-white border-2 rounded-xl p-6">
                                                    <div className="flex justify-between items-start mb-4">
                                                        <div>
                                                            <h3 className="text-xl font-bold">{person.name}</h3>
                                                            <p className="text-gray-600">{person.phone}</p>
                                                            {person.gpsActive && (
                                                                <span className="text-xs text-green-600 font-bold">?? GPS Activo</span>
                                                            )}
                                                        </div>
                                                        <button
                                                            onClick={() => deleteDeliveryPerson(person.id)}
                                                            className="text-red-500 hover:text-red-700"
                                                        >
                                                            ???
                                                        </button>
                                                    </div>

                                                    <div className="grid grid-cols-2 gap-4 mb-4">
                                                        <div className="bg-blue-50 p-3 rounded-lg text-center">
                                                            <div className="text-2xl font-bold text-blue-600">
                                                                {orders.filter(o => o.deliveryPerson === person.name && o.status !== 'delivered').length}
                                                            </div>
                                                            <div className="text-sm text-gray-600">Activos</div>
                                                        </div>
                                                        <div className="bg-green-50 p-3 rounded-lg text-center">
                                                            <div className="text-2xl font-bold text-green-600">
                                                                {orders.filter(o => o.deliveryPerson === person.name && o.status === 'delivered').length}
                                                            </div>
                                                            <div className="text-sm text-gray-600">Completados</div>
                                                        </div>
                                                    </div>

                                                    <button
                                                        onClick={() => copyDeliveryPersonUrl(person.id, person.name)}
                                                        className="w-full whatsapp-btn text-white px-4 py-3 rounded-lg font-bold"
                                                    >
                                                        ?? Enviar Link + WhatsApp
                                                    </button>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                {activeTab === 'waitlist' && (
                                    <div>
                                        <div className="mb-6">
                                            <h2 className="text-2xl font-bold">Lista de Espera</h2>
                                            <p className="text-gray-600">Orden de repartidores disponibles</p>
                                        </div>

                                        {waitlist.length > 0 ? (
                                            <div className="space-y-3">
                                                {waitlist.sort((a, b) => new Date(a.joinedAt) - new Date(b.joinedAt)).map((entry, index) => {
                                                    const person = deliveryPersons.find(p => p.id === entry.personId);
                                                    return (
                                                        <div key={entry.personId} className="bg-white border-2 rounded-xl p-4 waitlist-item">
                                                            <div className="waitlist-number">{index + 1}</div>
                                                            <div className="flex justify-between items-center">
                                                                <div>
                                                                    <h3 className="font-bold text-lg">{entry.personName}</h3>
                                                                    <p className="text-sm text-gray-500">
                                                                        Ingresó: {new Date(entry.joinedAt).toLocaleTimeString('es-CO')}
                                                                    </p>
                                                                    {person?.gpsActive && (
                                                                        <span className="text-xs text-green-600 font-bold">?? GPS Activo</span>
                                                                    )}
                                                                </div>
                                                                <div className="text-right">
                                                                    <span className="text-2xl">
                                                                        {index === 0 ? '??' : '?'}
                                                                    </span>
                                                                    <p className="text-xs text-gray-500 mt-1">
                                                                        {index === 0 ? 'Siguiente' : `Posición ${index + 1}`}
                                                                    </p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    );
                                                })}
                                            </div>
                                        ) : (
                                            <div className="bg-white rounded-xl shadow-lg p-12 text-center">
                                                <Icon d={icons.users} className="w-16 h-16 text-gray-300 mx-auto mb-4" />
                                                <h3 className="text-xl font-bold text-gray-900 mb-2">Lista vacía</h3>
                                                <p className="text-gray-600">No hay repartidores en lista de espera</p>
                                            </div>
                                        )}
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<DeliverySystem />, document.getElementById('root'));
    </script>
</body>
</html>